# Catering Service

## Описание
Catering Service — микросервис для управления процессом доставки питания на авиарейсы. Он автоматизирует отправку кейтеринг-машин к самолётам с заказанными порциями различных типов питания.

## Основные функции

- Приём и обработка запросов на доставку питания с указанием:
  - **AircraftId** — идентификатор самолёта.
  - **NodeId** — идентификатор точки назначения.
  - **Meals** — тип и количество заказанных порций (например, Standard, Vegetarian, Vegan, Gluten-Free).

- Автоматическое распределение задач на транспортные средства с учётом следующих ограничений:
  - **Общее ограничение:** Максимум 5 кейтеринг-машин в системе.
  - **Ограничение на самолёт:** Максимум 2 машины одновременно на один самолёт.

- Очередь запросов, если доступных машин недостаточно, до появления свободного транспорта.

- Интерфейс администратора:
  - Переключение режима работы (Mock или Real).
  - Настройка вместимости кейтеринг-машин.
  - Отправка тестовых запросов.
  - Просмотр текущего состояния машин и очередей в реальном времени.

### Запуск приложения

```bash
# Клонирование репозитория
git clone https://github.com/reaport/catering.git
cd CateringService

# Сборка проекта
dotnet build

# Запуск приложения
dotnet run
```

Откройте веб-интерфейс администратора по адресу:
```
https://localhost:5001/Admin/Index
```

## Использование API

### Запрос на доставку питания

- **URL:** `POST /request`
- **Тело запроса:**

```json
{
  "AircraftId": "AIR123",
  "NodeId": "NODE_A",
  "Meals": [
    { "mealType": "Standard", "count": 10 },
    { "mealType": "Vegetarian", "count": 5 }
  ]
}
```

### Получение доступных типов питания

- **URL:** `GET /mealtypes`
- **Успешный ответ (200):**

```json
{
  "mealTypes": ["Standard", "Vegetarian", "Vegan", "Gluten-Free"]
}
```

### Ответы API

- **Успешный ответ на запрос доставки (200):**

```json
{
  "Status": "success",
  "Waiting": false
}
```

- **Ошибка (400) при некорректных данных:**

```json
{
  "errorCode": 101,
  "message": "Each meal order must have a valid mealType and a non-negative count"
}
```

- **Ошибка (500) внутренняя ошибка:**

```json
{
  "errorCode": 500,
  "message": "InternalServerError"
}
```

## Веб-интерфейс администратора

### Возможности

- Переключение между Mock и Real режимами работы.
- Настройка вместимости транспортных средств.
- Форма для отправки тестовых запросов.
- Таблица со статусами кейтеринг-машин и очередей, обновляющаяся в режиме реального времени.

### Ограничения

- **Общий лимит машин:** не более 5.
- **Максимум на один самолёт:** не более 2 машин.
- Запросы ставятся в очередь, если превышен лимит машин.

## Логирование

Все операции сервиса логируются с использованием встроенных механизмов .NET для удобства мониторинга и отладки.
